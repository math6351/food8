<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <section id="header">
        <a href="index.html">
            <div id="logo"></div>
        </a>

        <button class="burgermenu">
           <div class="bar1"></div>
           <div class="bar2"></div>
           <div class="bar3"></div>
        </button>

        <nav id="hovedmenu">
            <ul>

                <a id="spisude" href="spisude.html">
                    <li id="spisude_billede">Spis ude</li>
                </a>
                <a id="spishjemme" href="spishjemme.html">
                    <li id="spishjemme_billede">Spis hjemme</li>
                </a>
                <a id="bookbord" href="bookbord.html">
                    <li id="bookbord_billede">Book bord</li>
                </a>
                <a id="selskaber" href="selskaber.html">
                    <li id="selskaber_billede">Skal du holde selskab?</li>
                </a>
                <a id="om" href="omfood8.html">
                    <li id="om_billede">Om Food8</li>
                </a>

            </ul>

        </nav>

    </section>

    <div id="cirkelboks">
        <div id="cirkel"></div>
    </div>

    <section class="liste" data-liste>
        <article class="restaurant_single">
            <img class="billede" data-banner src="" alt="">
            <h2 data-manchet></h2>
            <p data-beskrivelse></p>
        </article>
    </section>


    <section id="images">
        <h1 id="data-header">Vores verden</h1>

        <div id="slider" class="images" data-slider>

            <ul id="slides" data-slides>

            </ul>
        </div>
    </section>

    <template id="images-template" data-template>
            <li class="slide" data-slide>
                <img src="" alt="">
            </li>
    </template>

    <section class="info" data-info>
        <article class="restaurant_single">
            <div id="restaurant_single_container">
                <h2 id="sted_header" data-header></h2>
                <p id="sted_adresse" data-adresse></p>
                <p id="sted_hours" data-hours></p>
                <!--                    <a href="" data-link><img id="smiley" data-smiley src="" alt=""></a>-->
            </div>
        </article>
    </section>

    <section id="footer"></section>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="javascript.js"></script>

    <script>
        let url = new URL(window.location.href);
        let searchParams = new URLSearchParams(url.search);
        let id = searchParams.get("id");
        let jSonUrl = "http://mathildeoldorf.dk/kea/07-contentmanagement/food8/wordpress/wp-json/wp/v2/butikker/" + id;
        let butik = {};
        let sliderImages = [];
        let sliderImagesAlt = [];

        document.addEventListener("DOMContentLoaded", hentJson);

        async function hentJson() {
            let dataJson = await fetch(jSonUrl);
            butik = await dataJson.json();
            console.log("It's so fetch to be single, Gretchen!");
            visButik();
            hentInfo();
            //            visMenukort();

            hentSliderImages();
            placerSliderImages();
            startSliderImages();
        };

        function hentSliderImages() {
            console.log(sliderImages);
            if (butik.acf.indholds_billeder.url) {
                sliderImages.push(butik.acf.indholds_billeder.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder.alt);
            }

            if (butik.acf.indholds_billeder_1.url) {
                sliderImages.push(butik.acf.indholds_billeder_1.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_1.alt);
            }

            if (butik.acf.indholds_billeder_2.url) {
                sliderImages.push(butik.acf.indholds_billeder_2.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_2.alt);
            }

            if (butik.acf.indholds_billeder_3.url) {
                sliderImages.push(butik.acf.indholds_billeder_3.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_3.alt);
            }
            if (butik.acf.indholds_billeder_4) {
                sliderImages.push(butik.acf.indholds_billeder_4.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_4.alt);
            }
            if (butik.acf.indholds_billeder_5) {
                sliderImages.push(butik.acf.indholds_billeder_5.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_5.alt);
            }

            if (butik.acf.indholds_billeder_6) {
                sliderImages.push(butik.acf.indholds_billeder_6.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_6.alt);
            }

            if (butik.acf.indholds_billeder_7.url) {
                sliderImages.push(butik.acf.indholds_billeder_7.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_7.alt);
            }

            if (butik.acf.indholds_billeder_8.url) {
                sliderImages.push(butik.acf.indholds_billeder_8.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_8.alt);
            }

            if (butik.acf.indholds_billeder_9.url) {
                sliderImages.push(butik.acf.indholds_billeder_9.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_9.alt);
            }
            if (butik.acf.indholds_billeder_10.url) {
                sliderImages.push(butik.acf.indholds_billeder_10.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_10.alt);
            }

            if (butik.acf.indholds_billeder_11.url) {
                sliderImages.push(butik.acf.indholds_billeder_11.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_11.alt);
            }

            if (butik.acf.indholds_billeder_12.url) {
                sliderImages.push(butik.acf.indholds_billeder_12.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_12.alt);
            }

            if (butik.acf.indholds_billeder_13.url) {
                sliderImages.push(butik.acf.indholds_billeder_13.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_13.alt);
            }

            if (butik.acf.indholds_billeder_14.url) {
                sliderImages.push(butik.acf.indholds_billeder_14.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_14.alt);
            }

            if (butik.acf.indholds_billeder_15.url) {
                sliderImages.push(butik.acf.indholds_billeder_15.url),
                    sliderImagesAlt.push(butik.acf.indholds_billeder_15.alt);
            }
        }

        function placerSliderImages() {
            let display = document.querySelector("[data-slides]");

            let template = document.querySelector("[data-template]");

            console.log(sliderImages);

            sliderImages.forEach(sliderImage => {
                let klon = template.cloneNode(true).content;
                console.log(sliderImage);

                klon.querySelector("[data-slide] img").src = sliderImage;


                klon.querySelector("[data-slide] img").alt = "Billede af " + sliderImagesAlt;

                display.appendChild(klon);
            });
        }

        function visButik() {
            let display = document.querySelector("[data-liste]");
            display.querySelector("[data-banner]").src = butik.acf.splash_billed.url;
            display.querySelector("[data-banner]").alt = butik.acf.splash_billed.alt;
            display.querySelector("[data-manchet]").innerHTML = butik.acf.manchet;
            display.querySelector("[data-beskrivelse]").innerHTML = butik.acf.butik_beskrivelse;
            console.log("You're now in singleview!")
        };

        function hentInfo() {
            let display = document.querySelector("[data-info]");
            display.querySelector("[data-header]").textContent = butik.acf.butik_navn;
            display.querySelector("[data-adresse]").innerHTML = butik.acf.adresse;
            display.querySelector("[data-hours]").innerHTML = butik.acf.Ã¥bningstider;
            //            display.querySelector("[data-smiley]").src = butik.acf.kontrolrapport;

        }


        //        function visMenukort() {
        //            console.log(restauranter);
        //
        //            let display = document.querySelector("[data-menukortslides]");
        //            let template = document.querySelector("[data-menukorttemplate]");
        //            restauranter.forEach(restaurant => {
        //                let klon = template.cloneNode(true).content;
        //                console.log(restaurant);
        //                klon.querySelector("[data-header]").textContent = nyhed.acf.nyheds_title;
        //                klon.querySelector("[data-menukortslide] img").src = restaurant.acf.supplerende_billedemateriale2;
        //                console.log(klon.querySelector("[data-menukortslide]"));
        //                klon.querySelector("[data-menukortslide]").alt = "Billede af " + restaurant.acf.menukategorier;
        //                display.appendChild(klon);
        //            });
        //        }

        function startSliderImages() {

            var width = 565;
            var widthStor = 750;
            var animationSpeed = 1200;
            var pause = 5000;
            var currentSlide = 1;

            var $slider = $("[data-slider]");
            var $slideContainer = $slider.find("[data-slides]");
            var $slides = $slideContainer.find("[data-slide]");

            //           var $tekst = $("#preview-tekst");

            var mq = window.matchMedia('all and (min-width: 900px)');


            setInterval(function() {

                if (mq.matches) {
                    sliderSliderStor();
                } else {
                    sliderSlider();
                }


            }, pause);

            function sliderSlider() {
                console.log("sliderSlider");
                console.log("animationspeed er " + animationSpeed);
                console.log("pause er " + pause)
                $($slideContainer).animate({
                    "margin-left": "-=" + width
                }, animationSpeed, reset);
            }

            function reset() {

                currentSlide++;
                if (currentSlide === $slides.length) {
                    console.log("currentSlide = length");
                    currentSlide = 1;
                    $slideContainer.css({
                        "margin-left": "0"
                    });
                }
            }


            /** MEDIA QUIERY **/

            function sliderSliderStor() {
                console.log("sliderSliderStor");
                console.log("animationspeed er " + animationSpeed);
                console.log("pause er" + pause)
                $($slideContainer).animate({
                    "margin-left": "-=" + widthStor
                }, animationSpeed, reset);
            }

        }

    </script>

</body>

</html>
